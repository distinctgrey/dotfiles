# Homebrew env
eval "$(/opt/homebrew/bin/brew shellenv)" 2>/dev/null

# Add ~/bin to PATH for chezmoi utility scripts
export PATH="$HOME/bin:$PATH"

# 1Password SSH Agent
export SSH_AUTH_SOCK="$HOME/Library/Group Containers/2BUA8C4S2C.com.1password/t/agent.sock"

# Set Brewfile location for brew-file/brew-wrap
export HOMEBREW_BREWFILE="$HOME/.Brewfile"

# Wrap homebrew in brew-wrap (from homebrew-file)
if [[ -f "$(brew --prefix)/etc/brew-wrap" ]]; then
  source "$(brew --prefix)/etc/brew-wrap"

  _post_brewfile_update () {
    echo "Brewfile was updated! Run chezmoi-sync-brewfile to update your dotfiles."
  }
fi

eval "$(mise activate zsh)"
export EDITOR=nano
export VISUAL="$EDITOR"

# Load Phrase token from 1Password on shell start
if command -v op >/dev/null 2>&1; then
  export PHRASE_ACCESS_TOKEN="$(op read "op://Private/dotfiles secrets/add more/phrase_cli_token")"
fi

# Starship prompt (if installed)
if command -v starship >/dev/null 2>&1; then
  eval "$(starship init zsh)"
fi

eza_params=''
alias ls='eza $eza_params'
alias l='eza --git-ignore $eza_params'
alias ll='eza --all --header --long $eza_params'
alias llm='eza --all --header --long --sort=modified $eza_params'
alias la='eza -lbhHigUmuSa'
alias lx='eza -lbhHigUmuSa@'
alias lt='eza --tree $eza_params'
alias tree='eza --tree $eza_params'
